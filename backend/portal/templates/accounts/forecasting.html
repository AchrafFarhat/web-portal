{% extends 'accounts/main.html' %}

{% block content %}
  <div id="userChart"></div>
  <div id="trafficChart"></div>

  <!-- Load Plotly.js and Bootstrap from a CDN -->
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Prepare user chart data
    const userLabels = [
      {% for data_point in user_data %}
        "{{ data_point.x }}",
      {% endfor %}
    ];
    const userValues = [
      {% for data_point in user_data %}
        {{ data_point.y }},
      {% endfor %}
    ];
    const userForecastValues = [
      {% for data_point in user_forecast %}
        {{ data_point.y }},
      {% endfor %}
    ];

    // Prepare traffic chart data
    const trafficLabels = [
      {% for data_point in traffic_data %}
        "{{ data_point.x }}",
      {% endfor %}
    ];
    const trafficValues = [
      {% for data_point in traffic_data %}
        {{ data_point.y }},
      {% endfor %}
    ];
    const trafficForecastValues = [
      {% for data_point in traffic_forecast %}
        {{ data_point.y }},
      {% endfor %}
    ];

    // Create the user chart
    const userChart = {
      x: userLabels,
      y: userValues,
      name: 'Users',
      type: 'bar',
      marker: { color: 'rgba(0, 123, 255, 0.7)' }
    };

    const userForecastChart = {
      x: userLabels,
      y: userForecastValues,
      name: 'Forecasted Users',
      type: 'bar',
      marker: { color: 'rgba(255, 132, 0, 0.7)' }
    };

    Plotly.newPlot('userChart', [userChart, userForecastChart]);

    // Create the traffic chart
    const trafficChart = {
      x: trafficLabels,
      y: trafficValues,
      name: 'Traffic',
      type: 'bar',
      marker: { color: 'rgba(0, 123, 255, 0.7)' }
    };

    const trafficForecastChart = {
      x: trafficLabels,
      y: trafficForecastValues,
      name: 'Forecasted Traffic',
      type: 'bar',
      marker: { color: 'rgba(255, 132, 0, 0.7)' }
    };

    Plotly.newPlot('trafficChart', [trafficChart, trafficForecastChart]);
  </script>

{% endblock %}
